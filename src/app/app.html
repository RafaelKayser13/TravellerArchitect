<div class="app-shell">
  <div class="dice-layer" [class.active]="diceService.request() || npcService.request()">
    <app-dice-roller *ngIf="diceService.request()"></app-dice-roller>
    <app-npc-interaction *ngIf="npcService.request()"></app-npc-interaction>
  </div>

  <app-navigation-sidebar class="sys-sidebar"></app-navigation-sidebar>

  <div class="sys-workspace">
    <header class="sys-topbar">
      <div class="topbar-left">
        <div class="connection-status">
          <span class="status-dot"></span>
          <span class="status-text">NODE: ALPHA-7 // UPLINK_SECURE</span>
        </div>
      </div>
      
      <nav class="topbar-right">
        <div class="header-actions">
          <button class="system-menu-trigger" (click)="toggleSystemMenu()" [class.active]="showSystemMenu()">
            <span>SYSTEM_01</span>
            <svg viewBox="0 0 24 24" fill="none" class="icon-svg"><path d="M4 6H20M4 12H20M4 18H20" stroke="currentColor" stroke-width="2"/></svg>
          </button>
          
          <div class="system-dropdown" *ngIf="showSystemMenu()">
            <div class="menu-divider">// SUBSYSTEMS</div>
            <div class="menu-item" (click)="openEquipmentSelector()">
              <span class="item-icon">üì¶</span>
              <span class="item-label">EQUIPMENT_MATRIX</span>
            </div>
            <div class="menu-item" (click)="openWeaponSelector()">
              <span class="item-icon">üî´</span>
              <span class="item-label">WEAPON_DB</span>
            </div>
            <div class="menu-item" (click)="openArmorSelector()">
              <span class="item-icon">üõ°Ô∏è</span>
              <span class="item-label">ARMOR_DB</span>
            </div>

            <div class="menu-divider">// DEV_TOOLS</div>
            <div class="menu-item" (click)="toggleDebugMode()" [class.active]="diceService.debugMode()">
              <span class="item-icon">{{ diceService.debugMode() ? '‚ñ£' : '‚ñ°' }}</span>
              <span class="item-label">DEBUG_MODE</span>
            </div>
            <div class="menu-item" (click)="openDebug()">
              <span class="item-icon">üêû</span>
              <span class="item-label">SYS_CONSOLE</span>
            </div>
            <div class="menu-item" (click)="toggleSystemMenu()">
              <span class="item-icon">‚öô</span>
              <span class="item-label">CONFIG</span>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="sys-content">
      <router-outlet></router-outlet>
    </main>
  </div>

  <app-debug-floater></app-debug-floater>
</div>